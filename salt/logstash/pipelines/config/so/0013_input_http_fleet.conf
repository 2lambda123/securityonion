input {
  http {
    additional_codecs => { "application/json" => "json_lines" }
    port => 5056
    tags => [ "elastic-agent" ]
    ssl => true
    ssl_certificate_authorities => ["/usr/share/filebeat/ca.crt"]
    ssl_certificate => "/usr/share/logstash/filebeat.crt"
    ssl_key => "/usr/share/logstash/filebeat.key"
    ssl_verify_mode => "peer"
    ecs_compatibility => v8
  }
}

filter {
   if "elastic-agent" in [tags] {
  mutate {
    remove_field => ["http","[metadata][input]","url","user_agent"]
}
   }
}